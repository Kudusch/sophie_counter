<!DOCTYPE html>
<html lang='en'>

<head>
	<title>Sophie Scarf Counter</title>
	<meta charset='utf-8'>
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1,user-scalable=0" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<link rel="apple-touch-icon" sizes="512x512" href="apple-touch-icon.png">
	<link rel="stylesheet" href="styles.css">
	<script>
		if (localStorage.getItem("division_size") === null) {
			window.localStorage.setItem("division_size", 8);
		}
		let division_size = window.localStorage.getItem("division_size");

		if (localStorage.getItem("total_count") === null) {
			window.localStorage.setItem("total_count", 1);
		}
		let total_count = parseInt(window.localStorage.getItem("total_count"));

		if (localStorage.getItem("division_count") === null) {
			window.localStorage.setItem("division_count", total_count % division_size);
		}
		let division_count = parseInt(window.localStorage.getItem("division_count"));

		if (localStorage.getItem("cur_direction") === null) {
			window.localStorage.setItem("cur_direction", "increase");
		}
		let cur_direction = window.localStorage.getItem("cur_direction");

		let button_timer;


		function update_ui() {
			if (division_count == 0) {
				indicator.style.display = "block";
				division.style.display = "none";
			} else {
				indicator.style.display = "none";
				division.style.display = "block";
			}

			if (cur_direction == "increase") {
				settings.querySelectorAll("p")[0].style.color = "#669bbc";
				settings.querySelectorAll("p")[1].style.color = "#003049";
				direction.checked = false;

			} else {
				settings.querySelectorAll("p")[0].style.color = "#003049";
				settings.querySelectorAll("p")[1].style.color = "#669bbc";
				direction.checked = true;
			}

			document.querySelector("#total span.value").innerHTML = total_count;
			document.querySelector("#division span.value").innerHTML = division_size - division_count;
			document.querySelectorAll("span.direction").forEach(function(value) {
				value.innerHTML = cur_direction;
			});

			if (total_count % 2) {
				plus.style.setProperty("background-color", "#780000", "important");
				plus.style.setProperty("color", "#fdf0d5", "important");
				plus.style.setProperty("border", "10px dotted #fdf0d5", "important");
			} else {
				plus.style.setProperty("background-color", "#fdf0d5", "important");
				plus.style.setProperty("color", "#780000", "important");
				plus.style.setProperty("border", "10px dotted #780000", "important");
			}

		}
	</script>
</head>

<body ontouchstart="">
	<div id="display">
		<div id="total" class="counter">
			<p>You are starting<br>row <span class="value">1</span>.</p>
		</div>
		<div id="indicator">
			<p><span class="direction"></span><br>in this round!</p>
		</div>
		<div id="division" class="counter">
			<p>
				<span class="value">8</span> rows to go<br>until next <span class="direction"></span>.
			</p>
		</div>
	</div>
	<div id="ui">
		<button id="plus">
			<p>+</p>
		</button>
		<button id="undo">
			<p>-</p>
		</button>
		<button id="reset">
			<p>Reset</p>
		</button>
	</div>
	</div>
	<div id="settings">
		<p>Increase</p>
		<label class="switch">
			<input id="direction" class="toggle" type="checkbox">
			<span class="slider"></span>
		</label>
		<p>Decrease</p>
	</div>
	<footer>
		<p>Made by <a href="https://kudusch.de/" target="_blank">Kudusch</a> with love. Code and info on <a href="https://github.com/Kudusch/sophie_counter" target="_blank">Github</a>.</p>
	</footer>
</body>

<script>
	update_ui();

	plus.onclick = function() {
		total_count += 1;
		division_count = total_count % 8;
		window.localStorage.setItem("total_count", total_count);
		window.localStorage.setItem("division_count", division_count);

		update_ui();
	};
	undo.onclick = function() {
		total_count -= 1;
		division_count = total_count % 8;
		window.localStorage.setItem("total_count", total_count);
		window.localStorage.setItem("division_count", division_count);

		update_ui();
	};

	reset.onclick = function() {
		if (confirm("Reset?") == true) {
			total_count = 1;
			division_count = total_count % division_size;
			window.localStorage.setItem("total_count", total_count);
			window.localStorage.setItem("division_count", division_count);
			update_ui();
		}
	};

	direction.onclick = function() {
		if (cur_direction == "increase") {
			cur_direction = "decrease";
			settings.querySelectorAll("p")[1].style.color = "#669bbc";
			settings.querySelectorAll("p")[0].style.color = "#003049";
		} else {
			cur_direction = "increase";
			settings.querySelectorAll("p")[0].style.color = "#669bbc";
			settings.querySelectorAll("p")[1].style.color = "#003049";
		}
		window.localStorage.setItem("cur_direction", cur_direction);
		update_ui();
	}
</script>

</html>